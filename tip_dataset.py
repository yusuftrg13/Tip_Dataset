# -*- coding: utf-8 -*-
"""Tip_Dataset.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1N1z500HTN5Xql6FhsM8AYBhXzd4mqS4P
"""

#R dili ile veri üzerinde manipülasyon yapma ve incelemeleri öğreneceğiz

#Veri setini yükleme
data=read.csv('tip.csv')

#İlk 5 satırı görüntüleme
head(data)

#Veri yapısını kontrol edecegiz
str(data)

#Veri özetini görüntüle
summary(data)

#Eksik veri kontrolü yap
colSums(is.na(data))

#Bahşiş miktarı 5'ten büyük olanları alalım
high_tip=subset(data,tip>5)
head(high_tip)

#Sütun seçelim
selected_data=data[,c("tip","sex","smoker")]
head(selected_data)

# Bahşiş oranını hesaplayarak yeni bir sütun ekleyin
data$tip_percentage <- (data$tip / data$total_bill) * 100
head(data)

#Günlere göre ortalama bahşiş
average_tip=aggregate(tip_percentage  ~ day,data=data,FUN=mean)

print(average_tip)

#aggregate fonksiyonu,day sütununa göre gruplandırma yapar

#Cinsiyete göre tip değişim
tip_avg=aggregate(tip_percentage  ~ sex,data=data,FUN=mean)
print(tip_avg)

# Zaman dilimine göre bahşiş oranını hesaplayın
time_tip_avg <- aggregate(tip_percentage ~ time, data = data, FUN = mean)
print(time_tip_avg)

#Gruplara göre bahşiş

size_tip_avg <- aggregate(tip_percentage ~ size, data = data, FUN = mean)
print(size_tip_avg)

#Toplam bahşiş ile bahşiş oranı arası ilişki
plot(data$total_bill,data$tip_percentage,
main="Toplam Hesap ve Bahşiş İlişkisi",
xlab="Toplam Hesap",ylab="Bahşiş Oranı(%)")

#Günlere göre bahşiş dağılımı
library(ggplot2)

ggplot(data,aes(x=day,y=tip))+
  geom_bar(stat="summary",FUN="mean")+
  labs(title="Günlere göre Ortalama Bahşiş Dağılımı",x="Gün",y="Ortalama Bahşiş")

